# Advanced Docker Interview Questions 
---

## 61. How do you implement rate limiting for containers?

### Methods
- Use cgroups to limit CPU/IO:
  ```bash
  docker run --cpus="1.0" myapp
  docker run --device-read-bps /dev/sda:1mb myapp

* Use traffic shaping with `tc/netem`
* Use API gateways (Kong, NGINX, Traefik)
* Use Kubernetes LimitRange & ResourceQuota (if in K8s)

### Real-World Example

An internal API was being abused; rate limiting was enforced using NGINX reverse proxy in front of the container.

---

## 62. How do you manage image lifecycles in an enterprise setup?

### Components

* Versioning strategy (semantic, commit hashes)
* Automated cleanup of unused images
* Periodic vulnerability scanning
* Enforce immutability
* Maintain staging → prod promotion workflow
* Archival of EOL images

### Real-World Example

We maintained lifecycle policies in AWS ECR that automatically removed untagged images after 30 days.

---

## 63. What’s the role of container image scanning in DevSecOps?

### Explanation

Image scanning detects:

* CVEs (vulnerabilities)
* Misconfigurations
* Outdated libraries
* Malware
* Secret leaks

### Real-World Example

A Jenkins pipeline step ran Trivy scans and blocked deployments if high-severity vulnerabilities were found.

---

## 64. How do you detect and mitigate CVEs in base images?

### Steps

1. Use scanning tools (Trivy, Grype, Anchore)
2. Update base image regularly
3. Rebuild upstream dependencies
4. Replace vulnerable libraries
5. Consider switching to secure minimal images like distroless

### Real-World Example

A CVE in `python:3.10` forced us to upgrade all microservices to `python:3.11` across teams.

---

## 65. How do you rotate container credentials without downtime?

### Methods

* Use external secret managers (Vault, AWS Secrets Manager)
* Use short-lived tokens (STS, Vault dynamic secrets)
* Use config volume hot-reload watchers
* Use sidecar containers for credential refresh

### Real-World Example

We used Vault dynamic database credentials that rotated every 24 hours without restarting containers.

---

## 66. What’s the best way to share a Docker volume across multiple services?

### Methods

* Docker named volumes
* NFS-backed volumes
* CIFS/SMB shares
* Distributed FS: GlusterFS, CephFS
* Kubernetes Persistent Volumes with ReadWriteMany access mode

### Real-World Example

An image-processing pipeline used an NFS-mounted shared volume across three containers.

---

## 67. How do you secure Docker’s remote API?

### Methods

* Disable remote API unless required
* Use TLS certificates:

  ```json
  {
    "tls": true,
    "tlsverify": true,
    "tlscacert": "/ca.pem",
    "tlscert": "/server-cert.pem",
    "tlskey": "/server-key.pem"
  }
  ```
* Firewall restrict access to API port
* Never expose `/var/run/docker.sock` unnecessarily

### Real-World Example

We restricted the remote API to only CI/CD runner IP ranges using firewall rules and TLS.

---

## 68. What are the implications of Docker socket exposure?

### Explanation

Mounting Docker socket gives full root access to host, because anyone can:

* Start/stop containers
* Mount host FS
* Gain host root privileges

### Real-World Example

A security audit flagged an app using `/var/run/docker.sock`; it was replaced with a safer remote API + TLS approach.

---

## 69. How do you manage Docker Swarm secrets and configs?

### Secrets

```bash
echo "db_pass" | docker secret create db_pass -
docker service create --secret db_pass myapp
```

### Configs

```bash
docker config create app_config config.json
docker service create --config app_config myapp
```

### Real-World Example

Swarm services used secrets mounted in `/run/secrets/` for database credentials.

---

## 70. How do you handle rollbacks in Docker Swarm vs Kubernetes?

### Docker Swarm

```bash
docker service rollback myservice
```

### Kubernetes

```bash
kubectl rollout undo deployment/myapp
```

### Real-World Example

Swarm rollbacks were simpler, but K8s offered fine-grained rollback history and version control.

---

## 71. What are the challenges with multi-arch builds and how do you solve them?

### Challenges

* Architecture differences (ARM vs x86)
* Dependency incompatibility
* Emulator overhead

### Solutions

* Docker Buildx
* QEMU emulation
* Multi-arch manifest creation

### Real-World Example

We built images for Raspberry Pi (ARM) and AWS EC2 (x86) using Buildx.

---

## 72. How can you build images for ARM and x86 architectures?

### Commands using Buildx

```bash
docker buildx create --use
docker buildx build --platform linux/amd64,linux/arm64 -t myapp:multi .
```

### Real-World Example

IoT workloads required ARM images; we published multi-arch images to Docker Hub.

---

## 73. What is a layered filesystem in Docker and its pros/cons?

### Pros

* Efficient storage
* Fast builds
* Shared layers reduce disk usage

### Cons

* Too many layers slow down builds
* Debugging layer-specific issues is difficult
* Large writable layer impacts performance

### Real-World Example

Switching to multi-stage builds reduced unnecessary layers in our images.

---

## 74. How does Docker handle file system changes during container runtime?

### Explanation

Changes are written to the container’s writable layer (Copy-on-Write).
Read-only base layers stay unchanged.

### Real-World Example

Logging inside a container filled its writable layer, causing container failure before moving logs to a volume.

---

## 75. How can you trace file changes inside a running container?

### Tools

* `inotify-tools`
* `auditd`
* `docker diff <container>`
* `strace` for syscalls

### Example

```bash
docker diff container_id
```

### Real-World Example

We used `docker diff` to detect accidental writes to root filesystem.

---

## 76. How can you export container logs to external systems?

### Methods

* Logging drivers: fluentd, gelf, awslogs
* logspout
* Promtail → Loki
* Filebeat → Elasticsearch

### Real-World Example

EFK stack collected all app logs from Docker hosts for auditing.

---

## 77. What is Docker rootless mode and how do you enable it?

### Explanation

Rootless mode runs Docker without requiring root privileges.

### Enable

```bash
dockerd-rootless-setuptool.sh install
```

### Real-World Example

Developers used rootless mode to avoid needing sudo access on shared dev machines.

---

## 78. How do you implement backup and restore for containerized databases?

### Methods

* Volume tar backups:

  ```bash
  docker run --rm -v dbdata:/data -v $(pwd):/backup busybox tar czf /backup/db.tar.gz /data
  ```
* Native DB tools (mysqldump, pg_dump)
* Snapshots (AWS EBS snapshots, LVM)

### Real-World Example

Nightly MySQL volume tarball backups uploaded to S3 for retention.

---

## 79. What are best practices for ephemeral vs persistent volumes?

### Ephemeral

* Use tmpfs for sensitive/temp data
* Ideal for caching

### Persistent

* Use named volumes
* Use backup/snapshot strategy
* Never store persistent data in container FS

### Real-World Example

App session cache used tmpfs, database used a persistent EBS-backed volume.

---

## 80. How do you avoid storage bloat in containerized environments?

### Methods

* Regular pruning:

  ```bash
  docker system prune -af
  docker volume prune
  ```
* Clean unused images and layers
* Use lifecycle policies in registries
* Use multi-stage builds to reduce image size

### Real-World Example

CI servers scheduled weekly cleanup of dangling images to free up GBs of storage.

